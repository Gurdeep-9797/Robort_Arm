import{j as s,C as u,G as f,L as g,O as L,d as b,H as j,V as v}from"./vendor-three-CQaKo-2P.js";import{r as x}from"./vendor-react-F9Y4d3HK.js";import{u as h}from"./index-C-XieAK_.js";const m={base:"#3d5a80",shoulder:"#98c1d9",elbow:"#e0fbfc",wrist:"#ee6c4d",tool:"#293241",ghost:"#00ff0044"},o={L1:.15,L2:.3,L3:.25,L4:.1};function R(){const{jointPositions:r,showGhostRobot:e,ghostJoints:t,activeFrame:n}=h(),[c,l]=x.useState([]);return s.jsxs("div",{className:"robot-simulator",children:[s.jsxs(u,{camera:{position:[1,1,1],fov:50},shadows:!0,children:[s.jsx("ambientLight",{intensity:.4}),s.jsx("directionalLight",{position:[5,10,5],intensity:.8,castShadow:!0}),s.jsx("pointLight",{position:[-5,5,-5],intensity:.3}),s.jsx(f,{args:[2,2],cellSize:.1,cellColor:"#6e6e6e",sectionSize:.5,sectionColor:"#9e9e9e",fadeDistance:5}),s.jsx("axesHelper",{args:[.5]}),s.jsx(p,{joints:r,color:m,onTcpUpdate:a=>{l(i=>{const d=[...i,a];return d.length>100?d.slice(-100):d})}}),e&&s.jsx(p,{joints:t,color:{...m,base:"#00ff0044",shoulder:"#00ff0044",elbow:"#00ff0044",wrist:"#00ff0044"},isGhost:!0}),c.length>2&&s.jsx(g,{points:c,color:"#ff6b6b",lineWidth:2}),s.jsx(S,{activeFrame:n}),s.jsx(L,{enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:.5,maxDistance:3})]}),s.jsxs("div",{className:"simulator-overlay",children:[s.jsx(y,{}),s.jsx(w,{})]})]})}function p({joints:r,color:e,isGhost:t=!1,onTcpUpdate:n}){const c=x.useRef(),l=x.useRef(),a=r.map(i=>i*Math.PI/180);return b(()=>{if(l.current&&n){const i=new v;l.current.getWorldPosition(i),n([i.x,i.y,i.z])}}),s.jsxs("group",{ref:c,position:[0,0,0],children:[s.jsxs("mesh",{position:[0,o.L1/2,0],castShadow:!0,children:[s.jsx("cylinderGeometry",{args:[.08,.1,o.L1,32]}),s.jsx("meshStandardMaterial",{color:e.base,transparent:t,opacity:t?.3:1})]}),s.jsx("group",{rotation:[0,a[0],0],position:[0,o.L1,0],children:s.jsxs("group",{rotation:[0,0,a[1]],children:[s.jsxs("mesh",{position:[o.L2/2,0,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[o.L2,.06,.06]}),s.jsx("meshStandardMaterial",{color:e.shoulder,transparent:t,opacity:t?.3:1})]}),s.jsxs("mesh",{castShadow:!0,children:[s.jsx("sphereGeometry",{args:[.04,16,16]}),s.jsx("meshStandardMaterial",{color:e.wrist})]}),s.jsxs("group",{position:[o.L2,0,0],rotation:[0,0,a[2]],children:[s.jsxs("mesh",{position:[o.L3/2,0,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[o.L3,.05,.05]}),s.jsx("meshStandardMaterial",{color:e.elbow,transparent:t,opacity:t?.3:1})]}),s.jsxs("mesh",{castShadow:!0,children:[s.jsx("sphereGeometry",{args:[.035,16,16]}),s.jsx("meshStandardMaterial",{color:e.wrist})]}),s.jsxs("group",{position:[o.L3,0,0],rotation:[a[3],a[4],a[5]],ref:l,children:[s.jsxs("mesh",{position:[o.L4/2,0,0],castShadow:!0,children:[s.jsx("cylinderGeometry",{args:[.02,.03,o.L4,16],rotation:[0,0,Math.PI/2]}),s.jsx("meshStandardMaterial",{color:e.tool,transparent:t,opacity:t?.3:1})]}),s.jsxs("mesh",{position:[o.L4,0,0],children:[s.jsx("sphereGeometry",{args:[.015,16,16]}),s.jsx("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:.5})]}),s.jsx("axesHelper",{args:[.05],position:[o.L4,0,0]})]})]})]})})]})}function S({activeFrame:r}){return s.jsxs("group",{children:[s.jsxs("group",{position:[0,0,0],children:[s.jsx("axesHelper",{args:[.3]}),s.jsx(j,{position:[.32,0,0],children:s.jsx("div",{className:"frame-label world",children:"World"})})]}),s.jsxs("group",{position:[0,o.L1,0],children:[s.jsx("axesHelper",{args:[.2]}),s.jsx(j,{position:[.22,0,0],children:s.jsx("div",{className:"frame-label base",children:"Base"})})]})]})}function y(){const{activeFrame:r,setActiveFrame:e}=h();return s.jsxs("div",{className:"frame-selector",children:[s.jsx("label",{children:"Coordinate Frame:"}),s.jsxs("select",{value:r,onChange:t=>e(t.target.value),children:[s.jsx("option",{value:"WORLD",children:"World"}),s.jsx("option",{value:"BASE",children:"Base"}),s.jsx("option",{value:"TOOL",children:"Tool"})]})]})}function w(){const{jointPositions:r,tcpPosition:e}=h();return s.jsxs("div",{className:"joint-display",children:[s.jsx("h4",{children:"Joint Positions"}),s.jsx("div",{className:"joint-values",children:r.map((t,n)=>s.jsxs("div",{className:"joint-item",children:[s.jsxs("span",{className:"joint-label",children:["J",n,":"]}),s.jsxs("span",{className:"joint-value",children:[t.toFixed(1),"Â°"]})]},n))}),s.jsx("h4",{children:"TCP Position"}),s.jsxs("div",{className:"tcp-values",children:[s.jsxs("span",{children:["X: ",(e[0]*1e3).toFixed(1)," mm"]}),s.jsxs("span",{children:["Y: ",(e[1]*1e3).toFixed(1)," mm"]}),s.jsxs("span",{children:["Z: ",(e[2]*1e3).toFixed(1)," mm"]})]})]})}export{R as default};
